# ~/Documents/dotfile/.gitleaks.toml

title = "Geeker's Paranoid Config"

[allowlist]
description = "Global allowlist"
paths = [
    '''gitleaks.toml''',
    '''\.git/hooks''',
    '''\.gitignore''',
    '''raycast/\.config/raycast/extensions/'''
]

# === 规则 1: 强制捕获所有 api_key / token 字段 ===
[[rules]]
id = "generic-api-key"
description = "Generic API Key detection (Paranoid Mode)"
# 正则解释：匹配 api_key, apikey, secret, token，后面跟着 : 或 =，然后捕获值
regex = '''(?i)(api[_-]?key|secret|token|access[_-]?key|auth)[\"']?\s*[:=]\s*[\"']?([^\s\"']{8,})'''
secretGroup = 2
entropy = 3.0 # 降低熵值阈值（默认通常是 3.5+），让它更敏感
keywords = [
    "api_key",
    "apikey",
    "secret",
    "token"
]

# === 规则 2: 专门针对 OpenAI/Deepseek 风格的 sk- 开头 Key ===
[[rules]]
id = "sk-token"
description = "Potential AI Service Token (sk-...)"
regex = '''sk-[a-zA-Z0-9]{20,}'''
entropy = 3.0
keywords = [
    "sk-"
]

# 继承默认规则（可选，如果你想保留默认的 AWS 等检测）
[extend]
useDefault = true
